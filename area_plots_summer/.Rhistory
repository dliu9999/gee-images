setwd("C:/Users/DarrenPC/Desktop/Landsat/data/")
setwd("C:/Users/DarrenPC/Desktop/Landsat/areaplots/")
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/")
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/time_series")
filenames=list.files(getwd())
filenames
df = read.csv(filenames[1])
df
df$TOY =
beg = 0.328
end = 0.747
df$dates
df$dates % 1
df$dates + 1
df$dates %% 1
df$dates
df$dates %% 1
(df$dates %% 1) > 0.328
(datesMod >= beg) & (datesMod <= 0.747)
datesMod = df$dates %% 1
(datesMod >= beg) & (datesMod <= 0.747)
datesMod
filenames[1]
filenames[2]
filenames[2][1]
filenames[2][[1]]
filenames[2][3]
substring(filenames[2], 13)
substring(filenames[2], 14, 15)
substring(filenames[2], 14, 15) == 'N'
substring(filenames[2], 14, 15) == 'N '
substring(filenames[2], 14, 14) == 'N'
substring(filenames[2], 14, 14)
df[which((datesMod >= beg) & (datesMod <= end)), ]
df[which((datesMod >= beg) & (datesMod <= end)), ].length
df[which((datesMod >= beg) & (datesMod <= end)), ].nrow
df[which((datesMod >= beg) & (datesMod <= end)), ].nrows
nrow(df[which((datesMod >= beg) & (datesMod <= end)), ])
nrow(df)
df = read.csv(filenames[1])
lat = substring(filenames[1], latIndex, latIndex)
if (lat == 'N') {
print('yes')
}
lat = substring(filenames[1], latIndex, latIndex)
latIndex = 14
lat = substring(filenames[1], latIndex, latIndex)
if (lat == 'N') {
print('yes')
}
lat = substring(filenames[20], latIndex, latIndex)
if (lat == 'N') {
print('yes')
}
else {
print('no')
}
if (lat == 'N') {
print('yes')
}
if (lat == 'S') {
print('yes')
}
0.747 + 0.5
747 - 0.5
.747 - 0.5
df = read.csv(filenames[20])
subset = df[which((datesMod >= beg + 0.5) & (datesMod <= end - 0.5)), ]
df
datesMod = df$dates %% 1
(datesMod >= beg + 0.5) & (datesMod <= end - 0.5)
(datesMod >= (beg + 0.5)) & (datesMod <= (end - 0.5))
datesMod
(datesMod >= (beg + 0.5)) & (datesMod <= (end - 0.5))
datesMod >= beg + 0.5
subset = df[which((datesMod >= (beg + 0.5)) | (datesMod <= (end - 0.5))), ]
(datesMod >= (beg + 0.5)) | (datesMod <= (end - 0.5))
datesMod
beg + 0.5
df
subset
lm = lm(areas ~ time, data=subset)
sumlm = summary(lm)
sumlm
sumlm$coefficients[2, 1]
sumlm$coefficients[2, 2]
sumlm$r.squared
nrow(subset)
head(subset)
filenames[1]
substring(filenames[1], 1, 15)
substring(filenames[1], 1, 14)
plot(ts$dates, ts$areas, main=id, xlab='Year', ylab='Area (km^2)', type='l')
plot(subset$dates, subset$areas, main=id, xlab='Year', ylab='Area (km^2)', type='l')
plotlm = lm(areas ~ dates, data=subset)
sumplotlm = summary(plotlm)
abline(sumplotlm$coefficients[1:2], col="blue")
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/time_series")
filenames=list.files(getwd())
first = 0.328
second = 0.747
latIndex = 14
df = data.frame(id=NaN, start_date=NaN, end_date=NaN, slope=NaN, slope_error=NaN, intercept=NaN, intercept_error=NaN, r2=NaN, dpoints=NaN)
print('created empty df')
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/time_series")
filenames=list.files(getwd())
first = 0.328
second = 0.747
latIndex = 14
df = data.frame(id=NaN, start_date=NaN, end_date=NaN, slope=NaN, slope_error=NaN, intercept=NaN, intercept_error=NaN, r2=NaN, dpoints=NaN)
print('created empty df')
for (i in 1:length(filenames)) {
adsf
}
for (i in 1:length(filenames)) {
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/time_series")
}
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/time_series")
filenames=list.files(getwd())
first = 0.328
second = 0.747
latIndex = 14
df = data.frame(id=NaN, start_date=NaN, end_date=NaN, slope=NaN, slope_error=NaN, intercept=NaN, intercept_error=NaN, r2=NaN, dpoints=NaN)
print('created empty df')
for (i in 1:length(filenames)) {
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/time_series")
ts = read.csv(filenames[i])
datesMod = ts$dates %% 1
lat = substring(filenames[i], latIndex, latIndex)
if (lat == 'N') {
subset = ts[which((datesMod >= beg) & (datesMod <= end)), ]
}
else {
subset = ts[which((datesMod >= (beg + 0.5)) | (datesMod <= (end - 0.5))), ]
}
lm = lm(areas ~ time, data=subset)
sumlm = summary(lm)
df[i, ] = list("glac_id"=id,
"start_date"=floor(min(subset$dates)),
"end_date"=floor(max(subset$dates)),
"slope"=sumlm$coefficients[2, 1],
"slope_error"=sumlm$coefficients[2, 2],
"intercept"=sumlm$coefficients[1, 1],
"intercept_error"=sumlm$coefficients[1, 2],
"r2"=sumlm$r.squared,
"dpoints"=nrow(subset))
plotlm = lm(areas ~ dates, data=subset)
sumplotlm = summary(plotlm)
# Save plots
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots_summer")
id = substring(filenames[i], 1, 15)
png(paste(id, ".png", sep=""))
plot(subset$dates, subset$areas, main=id, xlab='Year', ylab='Area (km^2)', type='l')
abline(sumplotlm$coefficients[1:2], col="blue")
dev.off()
# Save Timeseries
write.csv(ts, paste("time_series/", filenames[i]))
print(paste("Finished ID", id))
}
for (i in 1:length(filenames)) {
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots/time_series")
ts = read.csv(filenames[i])
id = substring(filenames[i], 1, 15)
datesMod = ts$dates %% 1
lat = substring(filenames[i], latIndex, latIndex)
if (lat == 'N') {
subset = ts[which((datesMod >= beg) & (datesMod <= end)), ]
}
else {
subset = ts[which((datesMod >= (beg + 0.5)) | (datesMod <= (end - 0.5))), ]
}
lm = lm(areas ~ time, data=subset)
sumlm = summary(lm)
df[i, ] = list("glac_id"=id,
"start_date"=floor(min(subset$dates)),
"end_date"=floor(max(subset$dates)),
"slope"=sumlm$coefficients[2, 1],
"slope_error"=sumlm$coefficients[2, 2],
"intercept"=sumlm$coefficients[1, 1],
"intercept_error"=sumlm$coefficients[1, 2],
"r2"=sumlm$r.squared,
"dpoints"=nrow(subset))
plotlm = lm(areas ~ dates, data=subset)
sumplotlm = summary(plotlm)
# Save plots
setwd("C:/Users/DarrenPC/Desktop/Landsat/area_plots_summer")
png(paste(id, ".png", sep=""))
plot(subset$dates, subset$areas, main=id, xlab='Year', ylab='Area (km^2)', type='l')
abline(sumplotlm$coefficients[1:2], col="blue")
dev.off()
# Save Timeseries
write.csv(ts, paste("time_series/", filenames[i]))
print(paste("Finished ID", id))
}
df
write.csv(df,'area_df_summer.csv')
